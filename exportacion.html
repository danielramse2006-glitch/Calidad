<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Comentarios</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .container {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            padding: 30px;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        h2 {
            color: #2980b9;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        
        .error-message {
            background-color: #ffeaea;
            border: 1px solid #ffb8b8;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
            color: #d32f2f;
            font-weight: 500;
        }
        
        .error-message strong {
            display: block;
            margin-bottom: 5px;
        }
        
        .example {
            background-color: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-line;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            border-color: #3498db;
            outline: none;
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
        }
        
        .btn-secondary {
            background-color: #ecf0f1;
            color: #2c3e50;
        }
        
        .btn-secondary:hover {
            background-color: #d5dbdb;
        }
        
        .comments-section {
            margin-top: 40px;
        }
        
        .comment {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }
        
        .comment-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .comment-id {
            background-color: #3498db;
            color: white;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 14px;
        }
        
        .comment-content {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .comment-footer {
            color: #7f8c8d;
            font-size: 14px;
            font-style: italic;
        }
        
        .quote-example {
            background-color: #e8f4fc;
            border: 1px dashed #3498db;
            padding: 15px;
            margin-top: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 20px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Sistema de Comentarios</h1>
        <p>Formulario para agregar y formatear comentarios con referencias</p>
        
        <div class="error-message">
            <strong>Error detectado:</strong> "formatComments is not a function"
            <p>Este error ocurre cuando se intenta llamar a una función que no ha sido definida o no está disponible en el contexto actual.</p>
        </div>
        
        <h2>Ejemplo de formato de cita:</h2>
        <div class="example">3.Arias.- 9/19-el mismo

FG que el 88514385:</div>
        
        <h2>Agregar nuevo comentario</h2>
        <form id="commentForm">
            <div class="form-group">
                <label for="commentId">ID del comentario:</label>
                <input type="text" id="commentId" name="commentId" placeholder="Ej: 3" required>
            </div>
            
            <div class="form-group">
                <label for="author">Autor:</label>
                <input type="text" id="author" name="author" placeholder="Ej: Arias" required>
            </div>
            
            <div class="form-group">
                <label for="date">Fecha:</label>
                <input type="text" id="date" name="date" placeholder="Ej: 9/19" required>
            </div>
            
            <div class="form-group">
                <label for="reference">Referencia:</label>
                <input type="text" id="reference" name="reference" placeholder="Ej: el mismo" required>
            </div>
            
            <div class="form-group">
                <label for="content">Contenido del comentario:</label>
                <textarea id="content" name="content" placeholder="Escribe el contenido del comentario aquí..." required></textarea>
            </div>
            
            <div class="form-group">
                <label for="formatType">Formato de salida:</label>
                <select id="formatType" name="formatType">
                    <option value="standard">Formato estándar</option>
                    <option value="detailed">Formato detallado</option>
                </select>
            </div>
            
            <div class="button-group">
                <button type="submit" class="btn-primary" id="submitBtn">Agregar comentario</button>
                <button type="button" class="btn-secondary" id="formatExampleBtn">Ver ejemplo formateado</button>
            </div>
        </form>
        
        <div class="quote-example">
            <strong>Ejemplo de formato generado:</strong>
            <div id="exampleOutput"></div>
        </div>
        
        <div class="comments-section">
            <h2>Comentarios existentes</h2>
            <div id="commentsList">
                <!-- Los comentarios se cargarán aquí -->
            </div>
        </div>
    </div>

    <script>
        // Definición de la función formatComments para evitar el error
        function formatComments(commentData, formatType = "standard") {
            if (!commentData) {
                return "Error: Datos del comentario no proporcionados";
            }
            
            const { id, author, date, reference, content } = commentData;
            
            if (formatType === "detailed") {
                return `${id}.${author}.- ${date}-${reference}:\n\n${content}\n\n---`;
            } else {
                // Formato estándar
                return `${id}.${author}.- ${date}-${reference}:\n\n${content}`;
            }
        }
        
        // Función para mostrar un ejemplo del formato
        function showExample() {
            const exampleData = {
                id: 3,
                author: "Arias",
                date: "9/19",
                reference: "el mismo",
                content: "FG que el 88514385:"
            };
            
            const formattedExample = formatComments(exampleData, "standard");
            document.getElementById("exampleOutput").textContent = formattedExample;
        }
        
        // Función para manejar el envío del formulario
        function handleFormSubmit(event) {
            event.preventDefault();
            
            // Obtener datos del formulario
            const commentData = {
                id: document.getElementById("commentId").value,
                author: document.getElementById("author").value,
                date: document.getElementById("date").value,
                reference: document.getElementById("reference").value,
                content: document.getElementById("content").value
            };
            
            const formatType = document.getElementById("formatType").value;
            
            // Validar datos
            if (!commentData.id || !commentData.author || !commentData.date || !commentData.reference || !commentData.content) {
                alert("Por favor, complete todos los campos");
                return;
            }
            
            // Usar la función formatComments para formatear el comentario
            const formattedComment = formatComments(commentData, formatType);
            
            // Agregar el comentario a la lista
            addCommentToList(formattedComment, commentData);
            
            // Limpiar formulario
            document.getElementById("commentForm").reset();
            
            // Mostrar mensaje de éxito
            alert("Comentario agregado correctamente");
        }
        
        // Función para agregar comentario a la lista
        function addCommentToList(formattedText, commentData) {
            const commentsList = document.getElementById("commentsList");
            
            const commentElement = document.createElement("div");
            commentElement.className = "comment";
            
            const commentId = commentData.id;
            const commentDate = new Date().toLocaleDateString("es-ES");
            
            commentElement.innerHTML = `
                <div class="comment-header">
                    <span>Comentario #${commentId}</span>
                    <span class="comment-id">ID: ${commentId}</span>
                </div>
                <div class="comment-content">${formattedText.replace(/\n/g, '<br>')}</div>
                <div class="comment-footer">Agregado el: ${commentDate}</div>
            `;
            
            // Agregar al inicio de la lista
            commentsList.insertBefore(commentElement, commentsList.firstChild);
        }
        
        // Función para cargar comentarios de ejemplo
        function loadExampleComments() {
            const exampleComments = [
                {
                    id: 1,
                    author: "González",
                    date: "8/15",
                    reference: "expediente 552211",
                    content: "Se requiere revisión de documentación adjunta."
                },
                {
                    id: 2,
                    author: "Martínez",
                    date: "9/05",
                    reference: "ver anterior",
                    content: "Confirmar los datos del solicitante."
                }
            ];
            
            exampleComments.forEach(comment => {
                const formattedComment = formatComments(comment, "standard");
                addCommentToList(formattedComment, comment);
            });
        }
        
        // Inicializar la página
        document.addEventListener('DOMContentLoaded', function() {
            // Mostrar el ejemplo de formato
            showExample();
            
            // Cargar comentarios de ejemplo
            loadExampleComments();
            
            // Asignar manejadores de eventos
            document.getElementById('commentForm').addEventListener('submit', handleFormSubmit);
            document.getElementById('formatExampleBtn').addEventListener('click', showExample);
            
            // Confirmar que la función está disponible
            console.log("Función formatComments definida:", typeof formatComments);
        });
    </script>
</body>
</html>